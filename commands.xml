<?xml version="1.0" encoding="UTF-8"?>
<config>
	<aliases>
		<alias name="@1">tail -500
			/girdi/ARECA_DEPLOYMENT/areca/log/areca.out | grep
		</alias>
		<alias name="@2">| tail -1 | cut -f 2 -d"="</alias>
		<alias name="@3">| tail -1 | cut -f 2 -d"["</alias>
	</aliases>

	<commands>
		<command name="ExceptionCheck" title="Check for Exception">
			<connectBy>peste</connectBy>
			<cmd>tail -500 /girdi/ARECA_DEPLOYMENT/areca/log/areca.out</cmd>
		</command>

		<command name="T1" title="Dispatcher State Queue: ">
			<connectBy>peste</connectBy>
			<cmd>@1 processor.dispatcher_stage.totalQueueCount @2</cmd>
		</command>

		<command name="T2" title="Add Stage Queue: ">
			<connectBy>peste</connectBy>
			<cmd>@1 processor.add_stage.dispatcher.queueCount @2</cmd>
		</command>

		<command name="T3" title="DB Queue: ">
			<connectBy>peste</connectBy>
			<cmd>@1 StageTaskWriterQueueManager.totalQueueCount @2</cmd>
		</command>

		<command name="T4" title="Received Customer: ">
			<connectBy>peste</connectBy>
			<cmd>@1 wo.received.customer @2</cmd>
		</command>

		<command name="T5" title="Received Product: ">
			<connectBy>peste</connectBy>
			<cmd>@1 wo.received.product @2</cmd>
		</command>

		<command name="T6" title="Received Account: ">
			<connectBy>peste</connectBy>
			<cmd>@1 wo.received.account @2</cmd>
		</command>

		<command name="T7" title="CDR Insert: ">
			<connectBy>peste</connectBy>
			<cmd>@1 cdrInsert @2 | cut -f1 -d"]"</cmd>
		</command>

		<command name="T8" title="Time Map: ">
			<connectBy>peste</connectBy>
			<cmd>@1 TimeMap @3</cmd>
		</command>

		<command name="C0" title="Server Status-">
			<connectBy>peste</connectBy>
			<cmd>cd /girdi/ARECA_DEPLOYMENT/areca/bin/;./checkAreca.sh
			</cmd>
		</command>

		<command name="C1" title="İşlenmeyi bekleyen CDR Dosyası">
			<connectBy>peste</connectBy>
			<cmd>ls -l /girdi/realtime_archieve | wc -l</cmd>
		</command>

		<command name="C1" title="İşlenmeyi bekleyen ham CDR Sayısı: ">
			<connectBy>peste</connectBy>
			<cmd>ls -l /girdi/realtime_archieve | wc -l</cmd>
		</command>

		<command name="C1a" title="Taşınmayı Bekleyen CDR Dosyası: ">
			<connectBy>peste</connectBy>
			<cmd>ls -l /girdi/realtime_cdr | wc -l</cmd>
		</command>

		<command name="C1b" title="Tasinmayi Bekleyen S12 CDR Dosyasi: ">
			<connectBy>peste</connectBy>
			<cmd>ls -l /girdi/realtime_cdr_s12 | wc -l</cmd>
		</command>

		<command name="C2" title="Hata logu">
			<connectBy>peste</connectBy>
			<cmd>tail -50 /girdi/ARECA_DEPLOYMENT/areca/log/areca.err</cmd>
		</command>

		<command name="C3" title="Log">
			<connectBy>peste</connectBy>
			<cmd>tail -50 /girdi/ARECA_DEPLOYMENT/areca/log/areca.out</cmd>
		</command>

		<command name="cmdPartition" title="">
			<connectBy>peste</connectBy>
			<cmd>tail -1000 /girdi/ARECA_DEPLOYMENT/areca/log/areca.out | grep
				Partition
			</cmd>
		</command>

		<command name="Q1" title="Dün itibariyle yapılan bildirim dağılımı">
			<connectBy>sinan</connectBy>
			<cmd>select /* + parallel(x,8) */ COUNT(*) as TOPLAM,
				NOTIFICATION_TYPE,
				EVENT_TYPE from ARC_ABONE_BILDIRIM x
				where
				NOTIFICATION_DATE LIKE
				'#yesterday%'
				GROUP BY
				EVENT_TYPE,
				NOTIFICATION_TYPE
			</cmd>
			<note>Not: Günlük ortalama %80 bildirim sayısı yaklaşık 15,000 ve
				%100 bildirim sayısı yaklaşık 10,000 ve yukarısi olmalıdır.</note>
		</command>

		<command name="Q2" title="Bugün itibariyle yapılan bildirim dağılımı">
			<connectBy>sinan</connectBy>
			<cmd>select /* + parallel(x,8) */ COUNT(*) as TOPLAM,
				NOTIFICATION_TYPE,
				EVENT_TYPE from ARC_ABONE_BILDIRIM x
				where
				NOTIFICATION_DATE LIKE
				'#today%'
				GROUP BY EVENT_TYPE,
				NOTIFICATION_TYPE
			</cmd>
		</command>

		<command name="Q3" title="Okunmuş ama henüz işlenmemiş CDR">
			<connectBy>sinan</connectBy>
			<cmd>select /* + parallel(x,8) */ COUNT(*) as CDR from
				ARC_CDR_RAW_DATA x
				where STATUS=0 and DONEM=#donem
			</cmd>
		</command>

		<command name="QTest" title="Test ışöğüÜİŞ">
			<connectBy>sinan</connectBy>
			<cmd>select COUNT(*) from TAH_DONEM
			</cmd>
		</command>
	</commands>

	<reports>
		<report name="Monitor">
			<executeList>
				<cmd>C0</cmd>
				<cmd>C1</cmd>
				<cmd>C1a</cmd>
				<cmd>C1b</cmd>
				<cmd>C2</cmd>
				<cmd>C3</cmd>
				<cmd>T1</cmd>
				<cmd>T2</cmd>
				<cmd>T3</cmd>
				<cmd>T4</cmd>
				<cmd>T5</cmd>
				<cmd>T6</cmd>
				<cmd>T7</cmd>
				<cmd>T8</cmd>
			</executeList>
		</report>

		<report name="RptDaily" mail="areca">
			<title>KMSH/FÜS Bildirim Raporu</title>
			<executeList>
				<cmd>Q1</cmd>
				<cmd>Q2</cmd>
				<cmd>Q3</cmd>
				<cmd>C0</cmd>
				<cmd>C1</cmd>
				<cmd>C1a</cmd>
				<cmd>C1b</cmd>
				<cmd>T1</cmd>
				<cmd>T2</cmd>
				<cmd>T3</cmd>
				<cmd>T4</cmd>
				<cmd>T5</cmd>
				<cmd>T6</cmd>
				<cmd>T7</cmd>
				<cmd>T8</cmd>
			</executeList>
		</report>

		<report name="KMSHStopped" mail="areca" sms="acil">
			<title>KMSH/FÜS Stopped</title>
			<executeList>
				<cmd>C0</cmd>
			</executeList>
			<reportCondition>
				<precondition>(.*)running(.*)</precondition>
				<postcondition>(.*)stopped(.*)</postcondition>
			</reportCondition>
		</report>

		<report name="KMSHStarted" mail="areca" sms="acil">
			<title>KMSH/FÜS Started</title>
			<executeList>
				<cmd>C0</cmd>
			</executeList>
			<reportCondition>
				<precondition>(.*)stopped(.*)</precondition>
				<postcondition>(.*)running(.*)</postcondition>
			</reportCondition>
		</report>

		<report name="PartitionControl" mail="partition" sms="mex">
			<title>KMSH Partition Hatası !!!</title>
			<executeList>
				<cmd>cmdPartition</cmd>
			</executeList>
			<reportCondition>
				<postcondition>(.*)Partition error(.*)</postcondition>
			</reportCondition>
			<note>Not: Acil olarak mustafa.samatli@turktelekom.com.tr'ye e-mail
				ile bildirimde bulunun.
			</note>
		</report>

		<report name="Test" mail="me" sms="mex">
			<title>Test Rapouru ıöşçğ</title>
			<executeList>
				<cmd>C0</cmd>
				<cmd>T1</cmd>
				<cmd>QTest</cmd>
			</executeList>
			<reportCondition>
			</reportCondition>
			<note>Test note satırı</note>
		</report>
	</reports>
</config>